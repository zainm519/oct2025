<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Statue à bulles</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Ajout du curseur pour détecter les clics -->
      <a-entity camera look-controls>
        <a-entity cursor="rayOrigin: mouse"></a-entity>
      </a-entity>

      <!-- Ciel -->
      <a-sky color="#001f3f"></a-sky>

      <!-- Statue avec bulles -->
      <a-box id="statue" position="0 0 -4" color="#888" bubble-emitter></a-box>
    </a-scene>

    <!-- Script des bulles -->
    <script>
      AFRAME.registerComponent('bubble-emitter', {
        init: function () {
          this.el.addEventListener('click', () => {
            for (let i = 0; i < 10; i++) {
              this.spawnBubble();
            }
          });
        },

        spawnBubble: function () {
          const bubble = document.createElement('a-sphere');
          const pos = this.el.object3D.position;

          const x = pos.x + (Math.random() - 0.5) * 0.5;
          const y = pos.y + 1;
          const z = pos.z + (Math.random() - 0.5) * 0.5;

          bubble.setAttribute('position', { x, y, z });
          bubble.setAttribute('radius', 0.05 + Math.random() * 0.05);
          bubble.setAttribute('color', '#aeeeee');
          bubble.setAttribute('opacity', 0.6);
          bubble.setAttribute('transparent', true);

          bubble.setAttribute('animation__move', {
            property: 'position',
            to: `${x} ${y + 3} ${z}`,
            dur: 3000 + Math.random() * 1000,
            easing: 'easeOutQuad'
          });

          bubble.setAttribute('animation__fade', {
            property: 'material.opacity',
            to: 0,
            dur: 3000 + Math.random() * 1000,
            easing: 'linear'
          });

          setTimeout(() => {
            bubble.remove();
          }, 4000);

          document.querySelector('a-scene').appendChild(bubble);
        }
      });
    </script>
  </body>
</html>
